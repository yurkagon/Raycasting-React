(this["webpackJsonpraycasting-react"]=this["webpackJsonpraycasting-react"]||[]).push([[0],{18:function(t,e,n){},20:function(t,e,n){},21:function(t,e,n){},22:function(t,e,n){},23:function(t,e,n){},24:function(t,e,n){},25:function(t,e,n){"use strict";n.r(e);var i=n(1),a=n.n(i),r=n(11),s=n.n(r);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var o=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,26)).then((function(e){var n=e.getCLS,i=e.getFID,a=e.getFCP,r=e.getLCP,s=e.getTTFB;n(t),i(t),a(t),r(t),s(t)}))},c=n(3),u=n(12),h=n(2),l=n(4),f=n(13),d=n(5),v=n(9),b=n(8),g=function(){function t(){Object(h.a)(this,t),this.started=!1,y.getInstance().subscribe(this)}return Object(l.a)(t,[{key:"start",value:function(){this.started=!0}},{key:"isStarted",value:function(){return this.started}}]),t}(),j=function(){function t(){Object(h.a)(this,t),this.subscribers=[]}return Object(l.a)(t,[{key:"init",value:function(){var t=this;setInterval((function(){return t.update()}),10)}},{key:"update",value:function(){this.subscribers.forEach((function(t){t instanceof g?(t.isStarted()||t.start(),t.update()):t()}))}},{key:"subscribe",value:function(t){this.subscribers.push(t)}},{key:"unsubscribe",value:function(t){var e=this.subscribers.findIndex((function(e){return t===e}));this.subscribers.splice(e,1)}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new t),this.instance}}]),t}();j.instance=void 0;var y=j,p=n(6),O=function(){function t(){Object(h.a)(this,t),this.data=null,this.tileSize=32}return Object(l.a)(t,[{key:"setData",value:function(t){this.data=t}},{key:"isCollision",value:function(t){var e,n,i=this.convertPositionToGridPosition(t);return 0!==(null===(e=this.data)||void 0===e||null===(n=e[Math.floor(i.y)])||void 0===n?void 0:n[Math.floor(i.x)])?i:null}},{key:"convertPositionToGridPosition",value:function(t){return{x:t.x/this.tileSize,y:t.y/this.tileSize}}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new t),this.instance}}]),t}();O.instance=void 0;var m=O,x=function(){function t(){Object(h.a)(this,t),this.MOUSE_SENSITIVITY=1.5,this.ROTATION_SPEED=2,this.moveState={toForward:!1,toBack:!1,rotateLeft:!1,rotateRight:!1},this.attachKeyDown(),this.attachKeyUp()}return Object(l.a)(t,[{key:"attachKeyDown",value:function(){var t=this;document.body.addEventListener("keydown",(function(e){var n=e.code;"KeyW"===n&&(t.moveState.toForward=!0),"KeyS"===n&&(t.moveState.toBack=!0),"KeyA"===n&&(t.moveState.rotateLeft=!0),"KeyD"===n&&(t.moveState.rotateRight=!0)}))}},{key:"attachKeyUp",value:function(){var t=this;document.body.addEventListener("keyup",(function(e){var n=e.code;"KeyW"===n&&(t.moveState.toForward=!1),"KeyS"===n&&(t.moveState.toBack=!1),"KeyA"===n&&(t.moveState.rotateLeft=!1),"KeyD"===n&&(t.moveState.rotateRight=!1)}))}}]),t}(),w=function(t){Object(v.a)(n,t);var e=Object(b.a)(n);function n(){var t;Object(h.a)(this,n);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))).position={x:155.15374267341303,y:141.63397544881818,rotation:-1.8500490071139923},t.walkSpeed=1,t.rotationSpeed=V.toRad(2),t.radius=8,t.control=new x,t}return Object(l.a)(n,[{key:"update",value:function(){var t=this.control.moveState,e=t.rotateLeft,n=t.rotateRight,i=t.toForward,a=t.toBack;if(e||n){var r=n?1:-1;this.position=Object(p.a)(Object(p.a)({},this.position),{},{rotation:this.position.rotation+this.rotationSpeed*r})}if(i||a){var s=i?1:-1,o={x:Math.cos(this.position.rotation)*this.walkSpeed*s,y:Math.sin(this.position.rotation)*this.walkSpeed*s};this.moveBy(o)}}},{key:"moveBy",value:function(t){var e=m.getInstance(),n=Object(p.a)(Object(p.a)({},this.position),{},{x:this.position.x+t.x,y:this.position.y+t.y});e.isCollision(n)||(this.position=n)}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new n),this.instance}}]),n}(g);w.instance=void 0;var S=w,C=function(){function t(e,n){Object(h.a)(this,t),this.point=void 0,this.angle=void 0,this.hit=void 0,this.hitDistance=void 0,this.hitPercent=void 0,this.stripHeight=0,this.checkingDistance=.5,this.maxDistance=300,this.grid=m.getInstance(),this.angle=n,this.point=e,this.cast()}return Object(l.a)(t,[{key:"cast",value:function(){for(var t=0;t<this.maxDistance;){var e={x:Math.cos(this.angle)*t,y:Math.sin(this.angle)*t},n={x:this.point.x+e.x,y:this.point.y+e.y},i=this.grid.isCollision(n);if(i){this.hit=n,this.hitPercent={x:i.x%1,y:i.y%1},this.hitDistance=W(this.point,n),this.stripHeight=1e4/(Math.cos(S.getInstance().position.rotation-this.angle)*this.hitDistance);break}t+=this.checkingDistance}}}]),t}(),k=[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,1,0,1],[1,0,0,0,0,1,0,0,0,0,0,0,1,0,1],[1,1,1,1,0,0,0,0,0,0,1,0,1,0,1],[1,0,0,0,0,0,0,0,0,0,1,0,1,0,1],[1,0,0,0,0,0,0,0,1,1,1,1,1,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,0,0,0,1,1,1,1,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],M=function(t){Object(v.a)(n,t);var e=Object(b.a)(n);function n(){var t;Object(h.a)(this,n);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))).FOV=V.toRad(60),t.raysCount=160,t.player=S.getInstance(),t.grid=m.getInstance(),t.rays=[],t}return Object(l.a)(n,[{key:"start",value:function(){Object(f.a)(Object(d.a)(n.prototype),"start",this).call(this),this.grid.setData(k)}},{key:"update",value:function(){this.rays=[];for(var t=this.FOV/this.raysCount,e=this.player.position.rotation-this.FOV/2,n=0;n<this.raysCount;n++){var i=e+t*n;this.rays.push(new C(this.player.position,i))}}},{key:"setRaysCount",value:function(t){this.raysCount=t}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new n),this.instance}}]),n}(g);M.instance=void 0;var I=M,R=function(){var t=Object(i.useState)(null),e=Object(c.a)(t,2),n=e[0],a=e[1];return Object(i.useEffect)((function(){var t=y.getInstance(),e=I.getInstance(),n=function(){a(e.player.position)};return t.subscribe(n),function(){return t.unsubscribe(n)}}),[]),n},E=function(){var t=Object(i.useState)([]),e=Object(c.a)(t,2),n=e[0],a=e[1];return Object(i.useEffect)((function(){var t=y.getInstance(),e=I.getInstance(),n=function(){a(e.rays)};return t.subscribe(n),function(){return t.unsubscribe(n)}}),[]),n},H=(n(18),n(0)),D=function(){var t=E(),e=I.getInstance(),n=U(),i=n.width/e.raysCount;return Object(H.jsx)("div",{className:"div-render-strategy",children:t.map((function(t,e){return t.hit?Object(H.jsx)("div",{className:"strip",style:{width:i,height:t.stripHeight,left:i*e,top:(n.height-t.stripHeight)/2,backgroundColor:"rgba(0, ".concat(300*t.stripHeight/n.height,", ").concat(t.stripHeight/n.height*500,")")}},e):null}))})},N=n.p+"static/media/wall.2598404c.jpg",F=(n(20),function(){var t=E(),e=I.getInstance(),n=U(),i=n.width/e.raysCount;return Object(H.jsx)("div",{className:"div-render-strategy-textured",children:t.map((function(t,e){if(!t.hit)return null;var a=t.hitPercent.x*t.stripHeight;return Object(H.jsx)("div",{className:"strip",style:{width:i,height:t.stripHeight,left:i*e,top:(n.height-t.stripHeight)/2},children:Object(H.jsx)("div",{className:"texture",style:{backgroundImage:"url(".concat(N,")"),height:t.stripHeight,width:t.stripHeight,backgroundSize:"cover",backgroundPositionX:-a}})},e)}))})}),P=n(7),T=(n(21),function(){var t=E(),e=I.getInstance(),n=U();if(Object(i.useEffect)((function(){var t=e.raysCount;return e.setRaysCount(L.consoleRaysCount),function(){return e.setRaysCount(t)}}),[]),Object(i.useEffect)((function(){e.setRaysCount(Math.floor(n.width*L.viewportWidthToCharsScaleCoefficient))}),[n.width]),!t.length)return null;var a=Math.floor(n.height*L.viewportHeightToCharsScaleCoefficient),r=t.map((function(t){for(var e=Math.round(t.stripHeight/480*a),n=e>a?a:e,i=Array.from({length:n}).fill(_(n,a)),r=a-n,s=Math.ceil(r/2),o=r-s,c=0;c<s;c++)i.push(" ");for(var u=0;u<o;u++)i.unshift("_");return i})),s=Object(P.rotate)(r,270).map((function(t){return t.join("")})).join("\n");return Object(H.jsx)("div",{className:"text-render-strategy",children:Object(H.jsx)("textarea",{value:s,rows:a,readOnly:!0})})}),A=n.p+"static/media/devtools.39991061.jpeg",K=(n(22),function(){var t=Object(i.useState)(null),e=Object(c.a)(t,2),n=e[0],a=e[1],r=E(),s=I.getInstance(),o=U();Object(i.useEffect)((function(){var t=s.raysCount;return s.setRaysCount(L.consoleRaysCount),function(){return s.setRaysCount(t)}}),[]);var u=Math.floor(L.consoleHeight);return Object(i.useEffect)((function(){if(!r.length)return null;var t=r.map((function(t){for(var e=Math.round(t.stripHeight/480*u),n=e>u?u:e,i=Array.from({length:n}).fill(_(n,u)),a=u-n,r=Math.ceil(a/2),s=a-r,o=0;o<r;o++)i.push(" ");for(var c=0;c<s;c++)i.unshift("_");return i})),e=Object(P.rotate)(t,270).map((function(t){return t.join("")})).join("\n");a(e)}),[r]),Object(i.useEffect)((function(){n&&console.log(n)}),[n]),Object(H.jsx)("div",{className:"console-render-strategy",children:Object(H.jsxs)("div",{className:"description",children:[Object(H.jsx)("h3",{children:"Open browser console"}),Object(H.jsx)("img",{src:A,width:o.width})]})})}),z=function t(){Object(h.a)(this,t)};z.viewPortSizeMultiplier=.9,z.uiMapSizeMultiplier=.5,z.textRenderCharSpectre=",,:;I&&00%$@@#",z.viewportWidthToCharsScaleCoefficient=.33,z.viewportHeightToCharsScaleCoefficient=.166,z.consoleRaysCount=100,z.consoleHeight=40,z.renderingStrategies=[{name:"HTML <div> Shaded",component:D,raysCountChangeAvailable:!0},{name:"HTML <div> Textured (works ugly)",component:F,raysCountChangeAvailable:!0},{name:"HTML <textarea> (Only chrome)",component:T},{name:"Console in your Chrome (only) browser :D",component:K}];var L=z,B=function t(){Object(h.a)(this,t)};B.toRad=function(t){return t*Math.PI/180},B.toDeg=function(t){return 180*t/Math.PI};var V=B,W=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},_=function(t,e){var n=",,:;I&&00%$@@#",i=Math.round(t/e*n.length);i<0&&(i=0),i>=n.length&&(i=n.length-1);return n[i]},U=function(){var t=Object(u.a)();return{width:Math.round(t.width*L.viewPortSizeMultiplier),height:Math.round(t.height*L.viewPortSizeMultiplier)}},$=function(){var t=R();if(!t)return null;var e=I.getInstance(),n=2*e.player.radius;return Object(H.jsx)("div",{className:"player-marker",style:{top:t.y/2,left:t.x/2},children:Object(H.jsx)("div",{className:"marker-body",style:{height:n,width:n,top:-e.player.radius,left:-e.player.radius,transform:"rotate(".concat(t.rotation,"rad)")}})})},q=function(t){var e=t.from,n=t.to;n.x<e.x&&(e=t.to,n=t.from);var i=Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2)),a=Math.atan((n.y-e.y)/(n.x-e.x));return Object(H.jsx)("div",{style:{position:"absolute",transform:"translate(".concat(e.x-.5*i*(1-Math.cos(a)),"px, ").concat(e.y+.5*i*Math.sin(a),"px) rotate(").concat(a,"rad)"),width:"".concat(i,"px"),height:"".concat(0,"px"),borderBottom:"2px solid yellow"}})},G=function(){var t=E(),e=R();return e?Object(H.jsx)(i.Fragment,{children:t.map((function(t,n){return t.hit?n%20!==0?null:Object(H.jsx)(q,{from:{x:e.x/2,y:e.y/2},to:{x:t.hit.x/2,y:t.hit.y/2}},n):null}))}):null},J=(n(23),function(){var t=function(){var t=Object(i.useState)(null),e=Object(c.a)(t,2),n=e[0],a=e[1],r=Object(i.useState)(null),s=Object(c.a)(r,2),o=s[0],u=s[1];return Object(i.useEffect)((function(){var t=y.getInstance(),e=I.getInstance(),n=function(){a(e.grid.data),u(e.grid.tileSize)};return t.subscribe(n),function(){return t.unsubscribe(n)}}),[]),n?{data:n,tileSize:o}:null}();if(!t)return null;var e=t.tileSize/2,n=t.data.length,a=t.data[0].length*e,r=n*e;return Object(H.jsx)("div",{className:"ui-map",children:Object(H.jsxs)("div",{className:"cell-wrapper",style:{width:a,height:r},children:[Object(H.jsx)(G,{}),t.data.map((function(t,n){return Object(H.jsxs)(i.Fragment,{children:[t.map((function(t,i){return 0===t?null:Object(H.jsx)("div",{className:"cell",style:{top:n*e,left:i*e,width:e,height:e}},i)})),Object(H.jsx)($,{})]},n)}))]})})}),Y=function(){var t=I.getInstance(),e=Object(i.useState)(t.FOV),n=Object(c.a)(e,2),a=n[0],r=n[1],s=Object(i.useState)(t.raysCount),o=Object(c.a)(s,2),u=o[0],h=o[1],l=Object(i.useState)(L.renderingStrategies[0]),f=Object(c.a)(l,2),d=f[0],v=f[1];Object(i.useEffect)((function(){y.getInstance().init()}),[]),Object(i.useEffect)((function(){t.FOV=a}),[a]),Object(i.useEffect)((function(){t.raysCount=u}),[u]),Object(i.useEffect)((function(){h(t.raysCount)}),[d,t]);var b=U(),g=b.height,j=b.width;return Object(H.jsxs)("div",{className:"App",children:[Object(H.jsxs)("div",{className:"game-view-port",style:{width:j,height:g},children:[Object(H.jsx)(d.component,{}),Object(H.jsx)(J,{})]}),Object(H.jsxs)("div",{children:[Object(H.jsxs)("div",{children:["Rendering strategy:"," ",Object(H.jsx)("select",{onChange:function(t){var e=L.renderingStrategies.find((function(e){return e.name===t.target.value}));v(e)},value:d.name,autoFocus:!1,children:L.renderingStrategies.map((function(t){return Object(H.jsx)("option",{value:t.name,children:t.name},t.name)}))})]}),Object(H.jsxs)("div",{children:["FOV:","  ",Object(H.jsx)("input",{type:"range",min:"20",max:"150",value:V.toDeg(a),step:"10",onChange:function(t){return r(V.toRad(Number(t.target.value)))}}),"Value: ",Math.round(V.toDeg(a)),"\xb0 (default: 60\xb0)"]}),d.raysCountChangeAvailable&&Object(H.jsxs)("div",{children:["RAYS:",Object(H.jsx)("input",{type:"range",min:"10",max:"500",value:u,step:"10",onChange:function(t){return h(Number(t.target.value))}}),"Value: ",u," (default: 160)"]})]})]})};n(24);s.a.render(Object(H.jsx)(a.a.StrictMode,{children:Object(H.jsx)(Y,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)})),o()}},[[25,1,2]]]);
//# sourceMappingURL=main.181561bd.chunk.js.map